<div class="pdp-head-image">
  <img src="{{ product.metafields.snowboard_intro.background_image | image_url: "master" }}"alt="Capita | {{ product.title | strip_html }}">
  <h1>{{ product.title }}</h1>
</div>

<main class="main-page">

  <div class="c-product-gallery js-product-gallery">
    <div class="swiper">
      <div class="swiper-wrapper">

        {% for media in product.media %}
          {%- assign img_url = media | img_url: '1024x' -%}
          {%- assign img_url__attr = media | img_url -%}
          <div class="swiper-slide">
            <div class="c-product-gallery__item" 
              attr-img-url="{{img_url__attr}}" 
              attr-num="{{ forloop.index0 }}">
              <img class="js-product-gallery-item" src="{{ img_url }}" alt="{{ product.title | strip_html }}" />
            </div>
          </div>
      {% endfor %}

      </div>
      <button class="c-product-gallery__close js-product-gallery-close" type="button"><svg viewBox="0 0 41 41"
          fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="20.5" cy="20.5" r="19.5" stroke="black" stroke-width="2" />
          <path d="M26.2969 14.7017L14.6842 26.2821" stroke="black" stroke-width="2" stroke-linecap="round" />
          <path d="M26.2969 26.2983L14.7164 14.6857" stroke="black" stroke-width="2" stroke-linecap="round" />
        </svg>

      </button>
      <button class="c-product-gallery__nav is-prev js-product-gallery-prev" type="button"><svg viewBox="0 0 36 53"
          fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M25.7109 9.99984L10 26.3654L25.7109 42.731" stroke="black" stroke-width="2" stroke-linecap="round" />
        </svg>

      </button>
      <button class="c-product-gallery__nav is-next js-product-gallery-next" type="button"><svg viewBox="0 0 36 53"
          fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M10 9.99984L25.7109 26.3654L10 42.731" stroke="black" stroke-width="2" stroke-linecap="round" />
        </svg>

      </button>
    </div>
  </div>


  <div class="c-product">
    <div class="c-product__content js-product-slider">
      <div class="c-product__thumbs">
        <button class="c-product__thumb-nav-prev js-thumb-product-slider-prev" type="button"><svg viewBox="0 0 37 28"
            fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M10 17.92L18.25 10L26.5 17.92" stroke="black" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
        <div class="c-product__thumbs-slider swiper js-product-slider-thumbs">
          <div class="swiper-wrapper">
            {% for media in product.media %}
              {%- assign img_url = media | img_url: '1024x' -%}
              {%- assign img_url__attr = media | img_url -%}
              <div class="swiper-slide c-product__thumb" 
                attr-img-url="{{img_url__attr}}" 
                attr-num="{{ forloop.index0 }}"
                >
                <img src="{{ img_url }}" alt="{{ product.title | strip_html }}" />
              </div>
            {% endfor %}
          </div>
        </div>
        <button class="c-product__thumb-nav-next js-thumb-product-slider-next" type="button"><svg viewBox="0 0 37 29"
            fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M10 10.9511L18.25 18.8711L26.5 10.9511" stroke="black" stroke-width="2" stroke-linecap="round" />
          </svg>

        </button>
      </div>
      <div class="c-product__main swiper js-product-slider-main">
        <button class="c-product__main-magnify js-main-product-magnify" type="button"><svg viewBox="0 0 19 20"
            fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M10.8976 6.81592H8.17647V4.09481C8.17647 3.91439 8.1048 3.74135 7.97722 3.61378C7.84965 3.4862 7.67662 3.41453 7.49619 3.41453C7.31577 3.41453 7.14274 3.4862 7.01517 3.61378C6.88759 3.74135 6.81592 3.91439 6.81592 4.09481V6.81592H4.09481C3.91439 6.81592 3.74135 6.88759 3.61378 7.01517C3.4862 7.14274 3.41453 7.31577 3.41453 7.49619C3.41453 7.67662 3.4862 7.84965 3.61378 7.97722C3.74135 8.1048 3.91439 8.17647 4.09481 8.17647H6.81592V10.8976C6.81592 11.078 6.88759 11.251 7.01517 11.3786C7.14274 11.5062 7.31577 11.5779 7.49619 11.5779C7.67662 11.5779 7.84965 11.5062 7.97722 11.3786C8.1048 11.251 8.17647 11.078 8.17647 10.8976V8.17647H10.8976C11.078 8.17647 11.251 8.1048 11.3786 7.97722C11.5062 7.84965 11.5779 7.67662 11.5779 7.49619C11.5779 7.31577 11.5062 7.14274 11.3786 7.01517C11.251 6.88759 11.078 6.81592 10.8976 6.81592ZM18.8636 17.8976L13.2445 12.2581C14.4724 10.7766 15.0824 8.87908 14.9478 6.9596C14.8132 5.04013 13.9443 3.24627 12.5217 1.95063C11.0991 0.654986 9.23211 -0.0428596 7.30845 0.00203965C5.38478 0.0469389 3.55234 0.831132 2.19174 2.19174C0.831132 3.55234 0.0469389 5.38478 0.00203965 7.30845C-0.0428596 9.23211 0.654986 11.0991 1.95063 12.5217C3.24627 13.9443 5.04013 14.8132 6.9596 14.9478C8.87908 15.0824 10.7766 14.4724 12.2581 13.2445L17.8772 18.8636C18.0074 18.9751 18.1748 19.0333 18.346 19.0267C18.5172 19.0201 18.6796 18.9491 18.8008 18.828C18.9219 18.7068 18.9929 18.5444 18.9995 18.3732C19.0061 18.202 18.9479 18.0346 18.8364 17.9044L18.8636 17.8976ZM1.3737 7.49619C1.3737 6.28528 1.73277 5.10156 2.40552 4.09472C3.07827 3.08788 4.03447 2.30314 5.15322 1.83974C6.27196 1.37635 7.50299 1.2551 8.69063 1.49134C9.87828 1.72758 10.9692 2.31069 11.8255 3.16693C12.6817 4.02318 13.2648 5.11411 13.5011 6.30175C13.7373 7.4894 13.616 8.72043 13.1526 9.83917C12.6892 10.9579 11.9045 11.9141 10.8977 12.5869C9.89083 13.2596 8.70711 13.6187 7.49619 13.6187C5.87241 13.6187 4.31512 12.9736 3.16693 11.8255C2.01874 10.6773 1.3737 9.11998 1.3737 7.49619Z"
              fill="black" />
          </svg>
        </button>
        <div class="swiper-wrapper">

          {% for media in product.media %}
            {%- assign img_url = media | img_url: '1024x' -%}
            {%- assign img_url__attr = media | img_url -%}
        
            <div class="swiper-slide" 
              attr-img-url="{{img_url__attr}}" 
              attr-num="{{ forloop.index0 }}"
              >
              <img src="{{ img_url }}" alt="{{ product.title | strip_html }}">
            </div>
          {% endfor %}

        </div>
        <button class="c-product__main-nav-prev js-main-product-slider-prev" type="button"><svg viewBox="0 0 28 37"
            fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M17.9122 10L9.99219 18.25L17.9122 26.5" stroke="black" stroke-width="2" stroke-linecap="round" />
          </svg>

        </button>
        <button class="c-product__main-nav-next js-main-product-slider-next" type="button"><svg viewBox="0 0 28 37"
            fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M10.0058 10L17.9258 18.25L10.0058 26.5" stroke="black" stroke-width="2" stroke-linecap="round" />
          </svg>

        </button>
        <div class="swiper-pagination c-product__main-pagination js-main-product-pagination"></div>
      </div>

      {% include 'product-form' %}

    </div>
  </div>
      
  <div class="c-find-my-size js-find-my-size">
    <div class="c-find-my-size__bg"></div>
    <div class="c-find-my-size__content">
      <div class="c-find-my-size__top-buttons">
        <button class="c-find-my-size__restart" type="button"><svg fill="none" xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 15 15">
            <circle cx="7.5" cy="7.5" r="7" stroke="#000" />
            <path
              d="M7.482 10.999c-1.6-.034-2.93-1.414-2.98-3.05-.052-1.77 1.345-3.236 3.066-3.236V3.657c0-.136.153-.205.255-.12L9.39 4.884c.12.103.12.273 0 .375L7.823 6.604a.154.154 0 0 1-.255-.12V5.429c-1.33 0-2.402 1.108-2.385 2.488.017 1.294 1.09 2.384 2.35 2.401 1.33 0 2.42-1.09 2.42-2.453 0-.357-.086-.698-.222-1.005-.068-.136-.017-.306.102-.409a.335.335 0 0 1 .528.12c.17.391.273.834.273 1.294 0 1.755-1.414 3.186-3.151 3.135Z"
              fill="#000" /></svg></button>
        <button class="c-find-my-size__close" type="button"><svg fill="none" xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 15 15">
            <path fill-rule="evenodd" clip-rule="evenodd"
              d="M7.605 14.105a6.5 6.5 0 1 0 0-13 6.5 6.5 0 0 0 0 13Zm0 1a7.5 7.5 0 1 0 0-15 7.5 7.5 0 0 0 0 15Z"
              fill="#000" />
            <path fill-rule="evenodd" clip-rule="evenodd"
              d="M10.08 5.132a.5.5 0 0 1 0 .707l-4.243 4.243a.5.5 0 1 1-.707-.707l4.243-4.243a.5.5 0 0 1 .707 0Z"
              fill="#000" />
            <path fill-rule="evenodd" clip-rule="evenodd"
              d="M4.842 4.84a.5.5 0 0 1 .707 0l4.821 4.822a.5.5 0 1 1-.707.707L4.842 5.548a.5.5 0 0 1 0-.707Z"
              fill="#000" /></svg></button>
      </div><span class="c-find-my-size__title" style="display: none">Enter your information:</span>
      <form class="c-find-my-size__input" style="display: none">
        <div class="c-select-size js-select-size"><span class="c-select-size__label">Your height:</span>
          <div class="c-select-size__switch">
            <button class="is-active" type="button">cm</button>
            <button type="button">in</button>
          </div>
          <select class="c-select-size__select">
            <option value="120">120 cm</option>
            <option value="120">110 in</option>
          </select>
        </div>
        <div class="c-select-size js-select-size"><span class="c-select-size__label">Your height:</span>
          <div class="c-select-size__switch">
            <button class="is-active" type="button">cm</button>
            <button type="button">in</button>
          </div>
          <select class="c-select-size__select">
            <option value="120">120 cm</option>
            <option value="120">110 in</option>
          </select>
        </div>
        <div class="c-select-size js-select-size"><span class="c-select-size__label">Your height:</span>
          <div class="c-select-size__switch">
            <button class="is-active" type="button">cm</button>
            <button type="button">in</button>
          </div>
          <select class="c-select-size__select">
            <option value="120">120 cm</option>
            <option value="120">110 in</option>
          </select>
        </div>
        <button class="c-find-my-size__submit" type="submit">find my size</button>
      </form><span class="c-find-my-size__title">The best choices for you are:</span>
      <form class="c-find-my-size__choices" style="--choices: 2">
        <label class="c-find-my-size__choice"><img src="https://via.placeholder.com/132x332" alt="alt" />
          <input type="radio" name="name" /><span class="c-find-my-size__choice-button">152</span>
        </label>
        <label class="c-find-my-size__choice"><img src="https://via.placeholder.com/132x332" alt="alt" />
          <input type="radio" name="name" /><span class="c-find-my-size__choice-button">154</span>
        </label>
        <p class="c-find-my-size__description">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
          tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
          laboris nisi ut aliquip ex ea commodo consequat.</p>
        <button class="c-find-my-size__submit disabled" type="submit">find my size</button>
      </form>
    </div>
  </div>

  <div class="c-product-tech">
      <div class="c-product-tech__sx">
          <div class="c-product-tech__specs">
              <div class="c-spec"><span class="c-spec__type">shape</span><span class="c-spec__value">true twin</span>
              </div>
              <div class="c-spec"><span class="c-spec__type">sidecut</span><span class="c-spec__value">blended
                      radial</span></div>
              <div class="c-spec"><span class="c-spec__type">flex</span><span class="c-spec__value">{{ product.metafields.snowboard_info.flex_description }}</span>
                  <div class="c-spec__level is-blue" style="--dot-position: {{ product.metafields.snowboard_info.rating__flex }}; --steps: 10">
                      <div class="c-spec__dot"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                  </div>
              </div>
              <div class="c-spec"><span class="c-spec__type">rider type</span><span
                      class="c-spec__value">{{ product.metafields.snowboard_info.rider_type_title }}</span></div>
              <div class="c-spec"><span class="c-spec__type">skill level</span>
                  <div class="c-spec__level" style="--dot-position: 4; --steps: 5">
                      <div class="c-spec__dot"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                  </div>
              </div>
              <div class="c-spec"><span class="c-spec__type">TERRAIN VERSATILITY</span>
                  <div class="c-spec__level" style="--dot-position: {{ product.metafields.snowboard_info.rating__all_mtn }}; --steps: 5">
                      <div class="c-spec__dot"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                  </div>
              </div>
              <div class="c-spec"><span class="c-spec__type">GROOMERS</span>
                  <div class="c-spec__level" style="--dot-position: {{ product.metafields.snowboard_info.rating__performance }}; --steps: 5">
                      <div class="c-spec__dot"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                  </div>
              </div>
              <div class="c-spec"><span class="c-spec__type">POWDER</span>
                  <div class="c-spec__level" style="--dot-position: {{ product.metafields.snowboard_info.rating__powder }}; --steps: 5">
                      <div class="c-spec__dot"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                  </div>
              </div>
              <div class="c-spec"><span class="c-spec__type">JUMPS</span>
                  <div class="c-spec__level" style="--dot-position: {{ product.metafields.snowboard_info.rating__urban }}; --steps: 5">
                      <div class="c-spec__dot"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                  </div>
              </div>
              <div class="c-spec"><span class="c-spec__type">FLAT TRICK / JIBBING</span>
                  <div class="c-spec__level" style="--dot-position: {{ product.metafields.snowboard_info.rating__park }}; --steps: 5">
                      <div class="c-spec__dot"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                      <div class="c-spec__line"></div>
                  </div>
              </div>
          </div>
      </div>
      <div class="c-product-tech__dx">
          <div class="c-product-tech__story"><span class="c-product-tech__subtitle">tech story</span><span
                  class="c-product-tech__title">{{ product.title }}</span>
              <div class="c-product-tech__text">
                  {{ product.metafields.snowboard_info.snowboard_description }}
              </div>
          </div>
          <div class="c-product-tech__story"><span class="c-product-tech__subtitle">camber</span><span
                  class="c-product-tech__title"{{ product.metafields.snowboard_info.camber_type }}</span>
              <div class="c-product-tech__text">
                  {{ product.metafields.snowboard_info.camber_description }}
              </div>
          </div>
          <div class="c-product-tech__image">
            <img src="{{ product.metafields.snowboard_info.camber_image | image_url : "master" }}" alt="{{ product.title | strip_html }}">
          </div>
      </div>
      <div class="c-product-tech__video">

        <iframe 
          id="youtube-{{ product.metafields.snowboard_intro.product_video }}" 
          frameborder="0" 
          allowfullscreen="1" 
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
          title="Player for CAPiTA Snowboards | {{ product.title | strip_html }}" 
          width="100%" 
          height="100%" 
          src="https://www.youtube.com/embed/{{ product.metafields.snowboard_intro.product_video }}?autoplay=0;controls=0;disablekb=1;playsinline=1;cc_load_policy=0;cc_lang_pref=auto;">
        </iframe>
      
      </div>
  </div>

  <div class="c-product-details js-product-details">
    <div class="u-container">
      <div class="c-product-details__content">
        <div class="c-product-details__tabs js-details-tabs">
          <button class="c-product-details__tab-btn is-active js-details-tabs-btn" type="button" data-tab="constructions">constructions</button>
          <button class="c-product-details__tab-btn js-details-tabs-btn" type="button" data-tab="accolades">accolades</button>
          <button class="c-product-details__tab-btn js-details-tabs-btn" type="button" data-tab="size-chart">specs</button>
        </div>
        <div class="c-product-details__container">
          <!-- COMPONENTE SIZE CHART-->
          <div class="c-product-details__size-chart js-details-tabs-section" data-section="size-chart">
            <div class="c-size-chart swiper js-size-chart">
              <div class="swiper-wrapper">
                <div class="swiper-slide c-size-chart__column">


{{ product.metafields.snowboard_info.dimensions }}

                  {% comment %} <div class="c-size-chart__title-line"><span>length</span><span>EFFECTIVE EDGE (MM)</span><span>WAIST</span><span>NOSE/TAIL</span><span>SIDECUT</span><span>MAX STANCE (CM/INCHES)</span><span>SUGGESTED WEIGHT (LBS/KG)</span></div>
                  <div class="c-size-chart__values-line"><span>152</span><span>154</span><span>156</span><span>158</span><span>160</span><span>155W</span><span>158W</span></div>
                  <div class="c-size-chart__values-line"><span>152</span><span>154</span><span>156</span><span>158</span><span>160</span><span>155W</span><span>170-230+/77-104+</span></div> {% endcomment %}
                </div>
              </div>
              <div class="c-size-chart__scrollbar swiper-scrollbar"></div>
            </div>
          </div>
          <!-- FINE COMPONENTE SIZE CHAT-->
          <!-- COMPONENTE ACCOLADES-->
          <div class="c-product-details__accolades js-details-tabs-section" data-section="accolades">
            <div class="c-accolades"><span class="c-accolades__subtitle">AWARD:</span><span class="c-accolades__title">{{ product.metafields.accentuate.award_title }}</span>
              <div class="c-accolades__text">
                {{ product.metafields.accentuate.award_description.html }}
              </div>
              <div class="c-accolades__video">
                <iframe src="https://www.youtube.com/embed/{{ product.metafields.snowboard_info.award_video }}" title="Capita Award | {{ product.metafields.accentuate.award_title }}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen"></iframe>
              </div>
            </div>
          </div>
          <!-- FINE COMPONENTE ACCOLADES-->
          <!-- COMPONENTE CONSTRUCTIONS-->
          <div class="c-product-details__constructions js-details-tabs-section is-active" data-section="constructions">
            <div class="c-constructions js-constructions">
              <div class="c-constructions__dragger js-constructions-dragger swiper">
                <div class="swiper-wrapper">
                  <div class="swiper-slide">

                    <div class="c-hotspot js-constructions-hotspot" 
                      style="
                      --x-mob: {{ product.metafields.construction_hotspot.coordinates_x_mob }}; 
                      --x-desk: {{ product.metafields.construction_hotspot.coordinates_x_desk }}; 
                      --y-mob: {{ product.metafields.construction_hotspot.coordinates_y_mob }}; 
                      --y-desk: {{ product.metafields.construction_hotspot.coordinates_y_desk }};
                      " 
                      data-title="{{ product.metafields.construction_hotspot.board_construction_hotspot_title }}" 
                      data-descr="{{ product.metafields.construction_hotspot.board_construction_hotspot_description.html }}" 
                      data-image="{{ product.metafields.construction_hotspot.board_construction_hotspot_image | image_url: "master" }}"
                    >
                      <div class="c-hotspot__btn js-constructions-hotspot-btn">
                        <svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path fill-rule="evenodd" clip-rule="evenodd" d="M26 16c0 5.523-4.477 10-10 10S6 21.523 6 16 10.477 6 16 6s10 4.477 10 10Zm-5.169 0a.882.882 0 0 1-.882.882H16.98v3.492a.882.882 0 0 1-1.765 0v-3.492H12.25a.882.882 0 0 1 0-1.764h2.965v-3.493a.882.882 0 1 1 1.765 0v3.493h2.97c.486 0 .881.395.881.882Z"></path>
                          <circle cx="16" cy="16" r="15" stroke="#C8102E" stroke-width="2"></circle>
                        </svg>
                      </div>
                      <div class="c-hotspot__tooltip js-constructions-hotspot-tooltip" data-mob-x="right" data-mob-y="top"
                        data-desk-x="right" data-desk-y="bottom">
                        <button class="c-hotspot__read-more js-constructions-hotspot-read-more" type="button">
                          Read more<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="19.5" cy="19.5" r="7" />
                            <path d="M22.498 19.5H16.498" stroke-linecap="round" />
                            <path d="M19.5 16.0898V22.908" stroke-linecap="round" />
                          </svg>
  
                        </button><span class="c-hotspot__position">core</span><span class="c-hotspot__name">3d
                          thermopolymer supercore</span>
                      </div>
                    </div>

                    <picture><img class="c-constructions__image" src="{{ product.metafields.snowboard_info["3d_board_construction_image"] | image_url: "master" }}"/></picture>

                  </div>
                </div>
                <div class="c-constructions__scrollbar swiper-scrollbar"></div>
              </div>
            </div>
          </div>
          <!-- FINE COMPONENTE CONSTRUCTIONS-->
        </div>
      </div>
    </div>
  </div>
  <div class="u-container">
    <div class="c-info">
      <div class="c-info-card">
        <picture>
          <source media="(min-width: 1024px)" srcset="https://cdn.shopify.com/s/files/1/0231/7366/0752/files/madeclean.png?v=1687078547"/><img src="https://cdn.shopify.com/s/files/1/0231/7366/0752/files/madeclean.png?v=1687078547" alt="Capita clean energy"/>
        </picture>
        <a href="/pages/clean-energy"><span class="c-info-card__learn-more">learn more</span></a>
      </div>
      <div class="c-info-card">
        <picture>
          <source media="(min-width: 1024px)" srcset="https://cdn.shopify.com/s/files/1/0231/7366/0752/files/mothership.png?v=1687078547"/><img src="https://cdn.shopify.com/s/files/1/0231/7366/0752/files/mothership.png?v=1687078547" alt="Capita Mothership"/>
        </picture>
        <a href="/pages/mothership"><span class="c-info-card__learn-more">learn more</span></a>
      </div>
    </div>
  </div>

  {%- if recommendations.performed -%}
    <div class="c-related-products js-related-products">
      <div class="u-container">
        <div class="u-content">
          <h2 class="c-related-products__title">related products</h2>
          <div class="c-related-products__slider swiper">
            <div class="swiper-wrapper">

              {%- for product in recommendations.products -%}
                <div class="swiper-slide">
                  <div class="c-product-card">
                    <div class="c-product-card__media">
                      <img src="{{ product.featured_image | image_url: width: 360 }}" alt="Capita Related Product {{ product.title | strip_html }}"/>
                    </div>
                    <div class="c-product-card__info">
                      <span class="c-product-card__name">{{ product.title }}</span>
                      <span class="c-product-card__price">{{ product.price | money_with_currency }}</span>
                    </div>
                  </div>
                </div>
              {%- endfor -%}

            </div>
            <div class="c-related-products__scrollbar swiper-scrollbar"></div>
          </div>
        </div>
      </div>
    </div>
  {%- endif -%}
</main>


{% javascript %}

(function(document) {

  let selectors = {
    productVariants: '.js-product-variant:not(.is-disabled)',
    submitButton: '.js-add-to-cart',
    cartTrigger: '.js-cart-trigger',
    cartBtnsMinus: '.cart-qnt-btn-minus',
    cartBtnsPlus: '.cart-qnt-btn-plus',
    cartItems: '.c-cart-item',
    cartItemsLine: '.c-header-cart__line',
    cartItemsTot: '.c-cart-item__quantity-tot',
    cartSummary: '.c-header-cart__summary',
    msgEmptyCart: '.msg-empty-cart'
  };

  let productVariants = document.querySelectorAll(selectors.productVariants)
  let submitButton = document.querySelector(selectors.submitButton)
  let cartTrigger = document.querySelector(selectors.cartTrigger)
  let cartBtnsMinus = document.querySelectorAll(selectors.cartBtnsMinus)
  let cartBtnsPlus = document.querySelectorAll(selectors.cartBtnsPlus)
  let cartItems = document.querySelectorAll(selectors.cartItems)
  let cartItemsLine = document.querySelectorAll(selectors.cartItemsLine)
  let cartItemsTot = document.querySelectorAll(selectors.cartItemsTot)
  let cartSummary = document.querySelector(selectors.cartSummary)
  let msgEmptyCart = document.querySelector(selectors.msgEmptyCart)

  let itemList = { "items" : [], 'sections': 'cart-ajax' }

  window.addEventListener("load", (event) => {

    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
    let paramOpenCart = urlParams.get('opencart')
    if (paramOpenCart == "true") {
        cartTrigger.click()
        var scrollpos = localStorage.getItem('scrollpos');
        if (scrollpos) window.scrollTo({
            top: scrollpos,
            behavior: "smooth",
          });
    }

    window.onbeforeunload = function(e) {
        localStorage.setItem('scrollpos', window.scrollY);
    };


    productVariants.forEach((productVariant,i) => {

      productVariant.addEventListener("click", (e) => {

        itemList.items = []

        productVariants.forEach((productVariant__clean) => {
          productVariant__clean.classList.remove("selected")
        })

        if ( productVariant.classList.contains("selected") ) {
          productVariant.classList.remove("selected")
        } else {
          productVariant.classList.add("selected")
        }

        let productVariant__id = productVariant.querySelector("input").getAttribute("variant-id")

        jsonVariant = {
          'id': productVariant__id,
          'quantity': 1
        }
        itemList.items.push(jsonVariant)

      }, false)
          
    })

    submitButton.addEventListener("click", (e) => {

      submitButton.classList.add("disabled")
      cartSummary.classList.remove("hide")
      
      fetch('/cart/add.js', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(itemList)
      }).then(response => {
        return response.json();
      }).then(data => {

        console.log(data);

        submitButton.classList.remove("disabled")
        
        let disablePlus = false

        reloadCart(disablePlus)

      }).catch((error) => {
        console.error('Error:', error);
      });

    }, false)

    function changeCart(changeVariant, cartBtnVariation, limit) {
      fetch('/cart/change.js', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(changeVariant)
        }).then(response => {
          return response.json();
        }).then(data => {
          
          console.log(data); // prints HTML of the section 
          console.log(data.total_price); // prints HTML of the section 
          console.log(data.items); // prints HTML of the section 

          // Reloat Cart Total
          let newTotal = (parseInt(data.total_price)).toFixed(2) / 100
          let cartTotal = document.querySelector(".c-header-cart__total")
          let cartTotalVal = cartTotal.querySelector(".c-header-cart__total__val")
          let currentCurency = cartTotal.getAttribute("data-currency")
          cartTotalVal.innerHTML = currentCurency + newTotal
          
          // Remove Item = 0
          if (changeVariant.quantity == 0) {
            document.querySelector('.c-cart-item[data-id="'+changeVariant.id+'"]').remove()
          }

          // Reload page if empty cart
          if (data.item_count == 0) {
            location.assign(location.protocol + '//' + location.host + location.pathname)
            return;
          }

          // Reset all cart items quantity
          data.items.forEach((cartItem,i) => {

            let currentItem = document.querySelector('.c-cart-item[data-id="'+cartItem.id+'"]')
            let btnMinus = currentItem.querySelector(".cart-qnt-btn-minus")
            let btnPlus = currentItem.querySelector(".cart-qnt-btn-plus")

            currentItem.querySelector(".c-cart-item__quantity-tot").innerHTML = cartItem.quantity
            btnMinus.setAttribute("data-qnt", cartItem.quantity - 1)
            if (cartItem.quantity == limit) {
              btnPlus.classList.add("disabled")
            } else {
              btnPlus.classList.remove("disabled")
              btnPlus.setAttribute("data-qnt", cartItem.quantity + 1)
            }

          })

          // Re-enable btn variation
          cartBtnVariation.classList.remove("disable")

          
        }).catch((error) => {
          console.error('Error:', error);
        });
    }

    listenerMinus(cartBtnsMinus)

    function listenerMinus(cartBtnsMinus) {

      cartBtnsMinus.forEach((cartBtnMinus,i) => {
        cartBtnMinus.addEventListener("click", (e) => {

          cartBtnMinus.classList.add("disable")

          let dataID = cartBtnMinus.getAttribute("data-id")
          let dataQnt = cartBtnMinus.getAttribute("data-qnt")

          let currentItem = document.querySelector('.js-cart-item-limit[data-id="'+dataID+'"]')
          let currentLimit = currentItem.getAttribute("data-limit")
          let currentLimit__qnt = parseInt(currentLimit)

          let changeVariant = {
                'id': dataID,
                'quantity': dataQnt
              }

          changeCart(changeVariant, cartBtnMinus, currentLimit__qnt)

        }, false)
      })

    }

    listenerPlus(cartBtnsPlus) 
    
    function listenerPlus(cartBtnsPlus) {
      cartBtnsPlus.forEach((cartBtnPlus,i) => {
        cartBtnPlus.addEventListener("click", (e) => {

          cartBtnPlus.classList.add("disable")

          let dataID = cartBtnPlus.getAttribute("data-id")
          let dataQnt = cartBtnPlus.getAttribute("data-qnt")

          console.log(dataID)

          let currentItem = document.querySelector('.js-cart-item-limit[data-id="'+dataID+'"]')
          let currentLimit = currentItem.getAttribute("data-limit")
          let currentLimit__qnt = parseInt(currentLimit)

          console.log(currentLimit__qnt)

          let changeVariant = {
                'id': dataID,
                'quantity': dataQnt
              }

          changeCart(changeVariant, cartBtnPlus, currentLimit__qnt)

        }, false)
      })
    }


    function reloadCart(disablePlus) {

      fetch('/cart.js', {
        method: 'GET',
        headers: {
          'Content-Type': 'application/json'
        }
      }).then(response => {
        return response.json();
      }).then(data => {

        console.log(data); // prints HTML of the section 

        let cartAjax = document.querySelector('#cart-ajax')
        cartAjax.innerHTML = ""

        console.log(data.items)

        data.items.forEach((cartItem,i) => {

          let quantityMinus = cartItem.quantity - 1
          let quantityPlus = cartItem.quantity + 1
          let disablePlusClass = ""

          let cartTotal = document.querySelector(".c-header-cart__total")
          let cartTotalVal = cartTotal.querySelector(".c-header-cart__total__val")
          let currentCurency = cartTotal.getAttribute("data-currency")

          let finalPrice = (currentCurency + (cartItem.final_price / 100))
          // let finalPrice = (currentCurency + (cartItem.final_price / 100)).toFixed(2)

          if (disablePlus) {
            let disablePlusClass = "disabled"
          }

          var divCartItem = document.createElement('div');
          divCartItem.setAttribute('class', 'c-cart-item');
          divCartItem.setAttribute('data-id', cartItem.id);

          divCartItem.innerHTML = `
                    <div class="c-cart-item__container">
                        <a href="`+cartItem.url+`">
                            <img class="c-cart-item__image" src="`+cartItem.image+`" alt="`+cartItem.title+`">
                        </a>
                        <div class="c-cart-item__info"><span>`+cartItem.title+`</span>
                        </div>
                        <div class="c-cart-item__quantity">

                            <button 
                                class="c-cart-item__quantity-btn cart-qnt-btn-minus" 
                                type="button" 
                                data-id="`+cartItem.id+`" 
                                data-qnt="`+quantityMinus+`" >
                                    <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="19.5" cy="19.5" r="7" stroke="white" /><path d="M22.498 19.5H16.498" stroke="white" stroke-linecap="round" /></svg>
                            </button>
                            
                            <span class="c-cart-item__quantity-tot">`+cartItem.quantity+`</span>
                            
                            <button 
                                class="c-cart-item__quantity-btn cart-qnt-btn-plus `+disablePlusClass+`" 
                                type="button" 
                                data-id="`+cartItem.id+`" 
                                data-qnt="`+quantityPlus+`" >
                                    <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="19.5" cy="19.5" r="7" stroke="white" /><path d="M22.498 19.5H16.498" stroke="white" stroke-linecap="round" /><path d="M19.5 16.0898V22.908" stroke="white" stroke-linecap="round" /></svg>
                            </button>

                        </div>
                        <span class="c-cart-item__price">`+finalPrice+`</span>
                    </div>

                    <div class="c-header-cart__line"></div>
          `

          cartAjax.append(divCartItem)
          msgEmptyCart.classList.add("hide")

          if (!cartTrigger.classList.contains("is-active")) {
            setTimeout(() => {
              cartTrigger.click()
            }, 250);
          }

        })

        cartBtnsMinus = cartAjax.querySelectorAll(selectors.cartBtnsMinus)
        cartBtnsPlus = cartAjax.querySelectorAll(selectors.cartBtnsPlus)

        listenerMinus(cartBtnsMinus)
        listenerPlus(cartBtnsPlus)

      }).catch((error) => {
        console.error('Error:', error);
      });
      return;




    }

  })





  })(document);



{% endjavascript %}